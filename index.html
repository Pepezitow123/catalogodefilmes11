<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catálogo de Filmes - Fase 2</title>
<link rel="stylesheet" href="style.css">

<style>
  /* ======== ESTILOS GERAIS ======== */
  body {
    background-color: #001f3f; /* Azul escuro */
    color: white;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    text-align: center;
    flex-direction: column;
  }

  h1, h2 {
    color: #f0f0f0;
  }

  form {
    background-color: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
  }

  input {
    padding: 8px;
    border-radius: 5px;
    border: none;
    width: 250px;
    margin-top: 5px;
  }

  button {
    margin-top: 10px;
    padding: 10px 20px;
    background-color: #0074D9;
    border: none;
    border-radius: 5px;
    color: white;
    cursor: pointer;
  }

  button:hover {
    background-color: #005fa3;
  }

  #lista-filmes {
    margin-top: 20px;
    width: 80%;
    text-align: left;
  }

  .filme-item {
    display: flex;
    align-items: flex-start;
    gap: 15px;
    margin-top: 20px;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 10px;
    border-radius: 10px;
  }

  .filme-poster {
    width: 100px;
    height: 150px;
    object-fit: cover;
    border-radius: 5px;
  }

  .filme-info {
    flex: 1;
  }

  .filme-info h3 {
    margin-top: 0;
  }

  .filme-sinopse {
    font-size: 14px;
    color: #ddd;
    margin-top: 5px;
    line-height: 1.4;
  }

  .btn-remover {
    background-color: #FF4136;
  }

  .btn-remover:hover {
    background-color: #d9362f;
  }

  /* ======== SELETOR DE IDIOMA ======== */
  #idioma {
    position: absolute;
    top: 20px;
    right: 20px;
    background-color: #0074D9;
    border: none;
    color: white;
    padding: 6px 10px;
    border-radius: 5px;
  }
</style>
</head>

<body>
  <!-- SELETOR DE IDIOMA -->
  <select id="idioma">
    <option value="pt" selected>Português</option>
    <option value="en">English</option>
  </select>

  <h1 id="titulo-principal">Catálogo de Filmes</h1>

  <form id="cadastro-filme">
    <h2 id="subtitulo">Adicionar Novo Filme (Busca por API)</h2>
    <div>
      <label for="titulo" id="label-titulo">Título do Filme:</label><br>
      <input type="text" id="titulo" required>
    </div>

    <button type="submit" id="botao-buscar">Buscar e Adicionar Filme</button>
  </form>

  <hr style="width: 80%; border-color: rgba(255,255,255,0.3);">

  <h2 id="minha-lista">Minha Lista De Filmes</h2>
  <div id="lista-filmes">
    <p id="mensagem-vazia">Nenhum filme cadastrado ainda.</p>
  </div>

<script>
const API_KEY = 'dc96c932';
const catalogo = [];
const form = document.getElementById('cadastro-filme');
const tituloInput = document.getElementById('titulo');
const listaFilmesContainer = document.getElementById('lista-filmes');

// Função de remoção
function removerFilme(indice, elementoDOM) {
  catalogo.splice(indice, 1);
  elementoDOM.remove();
  if (catalogo.length === 0) {
    listaFilmesContainer.innerHTML = '<p id="mensagem-vazia">Nenhum filme cadastrado ainda.</p>';
  }
}

// Renderização
function renderizarFilme(filme, indice) {
  if (catalogo.length === 1) {
    listaFilmesContainer.innerHTML = '';
  }

  const filmeDiv = document.createElement('div');
  filmeDiv.classList.add('filme-item');

  const imagemPoster = document.createElement('img');
  imagemPoster.src = filme.poster && filme.poster !== 'N/A'
    ? filme.poster
    : 'https://via.placeholder.com/100x150?text=Poster+Nao+Disponivel';
  imagemPoster.alt = `Pôster do filme ${filme.titulo}`;
  imagemPoster.classList.add('filme-poster');

  const infoDiv = document.createElement('div');
  infoDiv.classList.add('filme-info');

  const tituloH3 = document.createElement('h3');
  tituloH3.textContent = filme.titulo;

  const sinopseP = document.createElement('p');
  sinopseP.textContent = filme.sinopse || (idiomaAtual === 'pt' ? 'Sinopse não disponível.' : 'Synopsis not available.');
  sinopseP.classList.add('filme-sinopse');

  const removerBotao = document.createElement('button');
  removerBotao.textContent = idiomaAtual === 'pt' ? 'Remover' : 'Remove';
  removerBotao.classList.add('btn-remover');

  removerBotao.addEventListener('click', () => {
    const indiceAtual = catalogo.findIndex(f => f.titulo === filme.titulo);
    if (indiceAtual > -1) {
      removerFilme(indiceAtual, filmeDiv);
    }
  });

  infoDiv.appendChild(tituloH3);
  infoDiv.appendChild(sinopseP);
  infoDiv.appendChild(removerBotao);

  filmeDiv.appendChild(imagemPoster);
  filmeDiv.appendChild(infoDiv);
  listaFilmesContainer.appendChild(filmeDiv);
}

// Função principal de busca
async function adicionarFilme(evento) {
  evento.preventDefault();
  const titulo = tituloInput.value.trim();
  if (!titulo) return;

  const tituloFormatado = encodeURIComponent(titulo);
  const url = `https://www.omdbapi.com/?apikey=${API_KEY}&t=${tituloFormatado}`;

  try {
    const resposta = await fetch(url);
    const dadosDoFilme = await resposta.json();

    if (dadosDoFilme.Response === "True") {
      const novoFilme = {
        titulo: dadosDoFilme.Title,
        poster: dadosDoFilme.Poster,
        sinopse: dadosDoFilme.Plot
      };
      catalogo.push(novoFilme);
      renderizarFilme(novoFilme, catalogo.length - 1);
    } else {
      alert(idiomaAtual === 'pt'
        ? `Filme não encontrado na OMDb: "${titulo}".`
        : `Movie not found in OMDb: "${titulo}".`);
    }
  } catch (error) {
    alert(idiomaAtual === 'pt'
      ? 'Ocorreu um erro ao tentar buscar o filme na API.'
      : 'An error occurred while fetching the movie from API.');
    console.error('Erro de Fetch:', error);
  }

  form.reset();
}

form.addEventListener('submit', adicionarFilme);

// ==== TROCA DE IDIOMA ====
const idiomaSelect = document.getElementById('idioma');
let idiomaAtual = 'pt';

const textos = {
  pt: {
    tituloPrincipal: 'Catálogo de Filmes',
    subtitulo: 'Adicionar Novo Filme (Busca por API)',
    labelTitulo: 'Título do Filme:',
    botaoBuscar: 'Buscar e Adicionar Filme',
    minhaLista: 'Minha Lista De Filmes',
    mensagemVazia: 'Nenhum filme cadastrado ainda.'
  },
  en: {
    tituloPrincipal: 'Movie Catalog',
    subtitulo: 'Add New Movie (API Search)',
    labelTitulo: 'Movie Title:',
    botaoBuscar: 'Search and Add Movie',
    minhaLista: 'My Movie List',
    mensagemVazia: 'No movies added yet.'
  }
};

function atualizarIdioma() {
  const t = textos[idiomaAtual];
  document.getElementById('titulo-principal').textContent = t.tituloPrincipal;
  document.getElementById('subtitulo').textContent = t.subtitulo;
  document.getElementById('label-titulo').textContent = t.labelTitulo;
  document.getElementById('botao-buscar').textContent = t.botaoBuscar;
  document.getElementById('minha-lista').textContent = t.minhaLista;
  document.getElementById('mensagem-vazia').textContent = t.mensagemVazia;
}

idiomaSelect.addEventListener('change', () => {
  idiomaAtual = idiomaSelect.value;
  atualizarIdioma();
});
</script>
</body>
</html>
